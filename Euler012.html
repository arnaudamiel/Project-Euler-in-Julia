<!DOCTYPE html>
<html>
<head>
<title>Project Euler 012</title>

<script language="Javascript">

function calculate()
{
 document.getElementById('result').innerHTML="Calculating ..."
 setTimeout(function(){startSolver()},1);
 
}

function startSolver()
{
 var start = new Date().getTime();
 var result = solve012();
 var end = new Date().getTime();
 var time = end - start;
 document.getElementById('result').innerHTML="Found : "+result+" in "+time+" ms";
}

function eratosthenes(limit)
{
 var primes = [];
 if (limit >= 2)
 {
  var sqrtlmt = Math.sqrt(limit) - 2;
  var nums = new Array(); // start with an empty Array...
  for (var i = 2; i <= limit; i++) // and
   nums.push(i); // only initialize the Array once...
  for (var i = 0; i <= sqrtlmt; i++)
  {
   var p = nums[i]
   if (p)
    for (var j = p * p - 2; j < nums.length; j += p)
     nums[j] = 0;
  }
  for (var i = 0; i < nums.length; i++)
  {
   var p = nums[i];
   if (p)
    primes.push(p);
  }
 }
 return primes;
}

function solve012()
{
 var solveTo = 500;
 var myPrimes = eratosthenes(2*solveTo);

 var n = 3;
 var Dn = 2;
 var cnt = 0;
 var n1;
 var Dn1;
 var i;
 var exponent;

 while (cnt <= solveTo)
 {
  n++;
  n1 = n;
  if (n1 % 2 ==0 )
   n1 /= 2;
  Dn1 = 1;

  for ( i=0; i < myPrimes.length; i++)
  {
   if (myPrimes[i] * myPrimes[i] > n1)
   {
    Dn1 *= 2;
    break;
   }

   //When the prime divisor would be greater than the residual n1,
   //that residual n1 is the last prime factor with an exponent=1
   //No necessity to identify it.

   exponent = 1;

   while (n1 % myPrimes[i] == 0)
   {
    exponent++;
    n1 /= myPrimes[i];
   }

   if (exponent > 1)
    Dn1 *= exponent;

   if (n1 == 1)
    break;

  }

  cnt = Dn*Dn1;
  Dn = Dn1;
 }

 return n*(n-1)/2;

}

</script>

</head>
<body>
<h1>Highly divisible triangular number</h1>
<h2>Problem 12</h2>
<div id="problem">
<p>The sequence of triangle numbers is generated by adding the natural numbers. So the 7<sup>th</sup> triangle number would be 1 + 2 + 3 + 4 + 5 + 6 + 7 = 28. The first ten terms would be:</p>
<p style="text-align:center;">1, 3, 6, 10, 15, 21, 28, 36, 45, 55, ...</p>
<p>Let us list the factors of the first seven triangle numbers:</p>
<blockquote style="font-family:courier new;"><b>&nbsp;1</b>: 1<br />
<b>&nbsp;3</b>: 1,3<br />
<b>&nbsp;6</b>: 1,2,3,6<br />
<b>10</b>: 1,2,5,10<br />
<b>15</b>: 1,3,5,15<br />
<b>21</b>: 1,3,7,21<br />
<b>28</b>: 1,2,4,7,14,28</blockquote>
<p>We can see that 28 is the first triangle number to have over five divisors.</p>
<p>What is the value of the first triangle number to have over five hundred divisors?</p>

</div>
<div id="result"></div>
<button onclick="calculate()">Click to calculate solution</button>
</body>
</html>